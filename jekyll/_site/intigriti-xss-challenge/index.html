<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js">
<!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <title>Winning Intigriti's XSS Challenge – Ryan Wise</title> <meta name="description" content="Full time software engineer, with freelance on the side. I do a lot of side projects involving electronics and technologies I find interesting. In addition I have a passion for cars, motorcycles and motorsport, I enjoy working on them and competing in events."> <meta name="keywords" content="XSS, Hacks, Bug Bounty, Exploits"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="/assets/img/logo.png"> <meta name="twitter:title" content="Winning Intigriti's XSS Challenge"> <meta name="twitter:description" content="I won one of Intigriti’s XSS challenge and got a Burp suite pro license! ($400)"> <meta name="twitter:site" content="@leobeosab"> <meta name="twitter:creator" content="@leobeosab"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Winning Intigriti's XSS Challenge"> <meta property="og:description" content="I won one of Intigriti’s XSS challenge and got a Burp suite pro license! ($400)"> <meta property="og:url" content="/intigriti-xss-challenge/"> <meta property="og:site_name" content="Ryan Wise"> <meta property="og:image" content="/assets/img/logo.png"> <link rel="canonical" href="/intigriti-xss-challenge/"> <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Ryan Wise Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="/assets/css/main.css"> <!-- JS --> <script src="/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="/favicon.png"> <link rel="shortcut icon" href="/favicon.ico"> <!-- Background Image --> <style type="text/css">body {background-image:url(/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140286077-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-140286077-1'); </script> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="/">Home</a></li> <li><a href="/about/">About</a></li> <li><a href="/projects/">Projects</a></li> <li><a href="/posts/">Posts</a></li> </ul> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>Winning Intigriti's XSS Challenge</h1> <h4>02 Sep 2019</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~3 minutes </p>
<!-- /.entry-reading-time --> <a class="btn zoombtn" href="/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <h2 id="intigriti-xss-challenge--3">Intigriti XSS Challenge # 3</h2> <p>Intigriti put out their third XSS challenge recently in late August 2019. I decided to try my hand on it as I’m new to Intigriti’s platform and bug hunting in general. The way it works is they put out an intentionally vulnerable <a href="https://challenge.intigriti.io/3/">webpage</a> just waiting for your xss payload. Out of everyone who submits a correct submission they will randomly pick one researcger and award them a one year Burp License and some private program invites.</p> <p>After a few hours of trying different things I finally got it. It was a difficult but rewarding and fun challenge. So I did a quick writeup on their submission page and sent it off. Within a couple hours it was confirmed and that was the end of it.. or so I thought.</p> <p>I woke up on September 2nd and I had a Twitter notification from Intigriti, I got selected as their one winner! It was awesome! Especially since I still didn’t have a Burp Suite Pro License. Thanks again to Intigriti for giving back to the community and being awesome!</p> <h2 id="okay-cool-but-how">Okay, Cool, but how?</h2> <p>Alright here is my writeup on how I tackled this challenge.</p> <h3 id="information-gathering">Information Gathering</h3> <p>Upon visiting the page for the first time you are greeted with an image containing the JS the page uses and the general rules for the challenge. The JS was interesting to say the least.</p> <div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">source</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLSerializer</span><span class="p">().</span><span class="nx">serializeToString</span><span class="p">(</span><span class="nb">document</span><span class="p">);</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">source</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div> <p>And the user’s PHPSESSID cookie just dangling at the bottom</p> <p><code class="highlighter-rouge">PHPSESSID=9ca3e188b91f6140323a987c00bc51c3</code></p> <p>From this we can tell it appends the user’s cookie(s) to the end of the page and then proceeds to take the page’s content and for some reason serializes and then deserializes it… Odd.</p> <h3 id="closing-in">Closing in</h3> <p>According to Intigriti’s hints on <a href="https://twitter.com/intigriti/status/1166309484328837121">twitter</a> it was a Chrome only XSS vuln which helps a lot to narrow down what we are looking for.</p> <p>After wasting hours looking for Chrome XSS vulns on exploit-db, CVE, etc. I decided that probably wasn’t the correct approach. So I moved onto comparing Chrome (which I never use) to Firefox (My ‘daily driver’ browser). I was pretty lucky and came upon a difference in the context menus when you right click on the page itself. Chrome has a “save as” option. So coupling that with Intigriti’s hint of “200 likes, time for a new hint! When we say ‘no self XSS’, we do NOT say ‘no obscure user interaction’”. It seemed pretty clear what we needed to checkout next.</p> <h2 id="the-attack">The Attack</h2> <h3 id="entry-point">Entry Point</h3> <p>When you save a page with Chrome’s super handy feature you get a nice .html and folder downloaded to whereever you’d like. Upon opening the file after I saved it I noticed this comment in the body.</p> <div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;body&gt;</span><span class="c">&lt;!-- saved from url=(0033)https://challenge.intigriti.io/3/ --&gt;</span>
...
<span class="nt">&lt;/body&gt;</span>
</code></pre></div> <p>We are so close you can.. I don’t know smell it?</p> <h3 id="payload-crafting">Payload Crafting</h3> <p>We just need an ending comment tag and a basic XSS Payload now to add to the end of our URL. In my case I just used this: <code class="highlighter-rouge">--&gt;&lt;img src=xss onerror=alert(1)&gt;</code> but that’s not a valid URL. All that needs to be done is to go to a JS console and the url with our payload added on in the encodeURI() function. And we get this</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nb">encodeURI</span><span class="p">(</span><span class="s2">"https://challenge.intigriti.io/3/--&gt;&lt;img src=xss onerror=alert(1)&gt;"</span><span class="p">);</span>
<span class="c1">// returns</span>
<span class="s2">"https://challenge.intigriti.io/3/--%3E%3Cimg%20src=xss%20onerror=alert(1)%3E"</span>
</code></pre></div> <h3 id="win">Win</h3> <p>Now just open in Chrome, save as a complete webpage and open locally and you should see a satisfying alert popup :)</p> <p><img src="/assets/img/posts/intigriti-xss-challenge/alert.png" alt="AlertImg"></p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="/tags/#XSS" title="Pages tagged XSS" class="tag"><span class="term">XSS</span></a><a href="/tags/#Hacks" title="Pages tagged Hacks" class="tag"><span class="term">Hacks</span></a><a href="/tags/#Bug%20Bounty" title="Pages tagged Bug Bounty" class="tag"><span class="term">Bug Bounty</span></a><a href="/tags/#Exploits" title="Pages tagged Exploits" class="tag"><span class="term">Exploits</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=/intigriti-xss-challenge/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=/intigriti-xss-challenge/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=/intigriti-xss-challenge/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> </header> <!-- JS --> <script src="/assets/js/jquery-1.12.0.min.js"></script> <script src="/assets/js/jquery.dlmenu.min.js"></script> <script src="/assets/js/jquery.goup.min.js"></script> <script src="/assets/js/jquery.magnific-popup.min.js"></script> <script src="/assets/js/jquery.fitvid.min.js"></script> <script src="/assets/js/scripts.js"></script> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
